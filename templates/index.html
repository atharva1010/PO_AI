<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PO AI Search</title>
<style>
body { font-family: Arial; padding: 20px; }
input[type="text"] { width: 80%; padding: 10px; font-size: 16px; }
button { padding: 10px 15px; font-size: 16px; }
.result { margin-top: 20px; border: 1px solid #ccc; padding: 10px; border-radius: 5px; }
.result b { cursor: pointer; }
@media(max-width:600px){ input[type="text"]{width:100%;} }
</style>
</head>
<body>

<h2>PO AI Search</h2>
<form id="searchForm" method="POST">
<input type="text" name="query" id="query" placeholder="Bolke ya type karke search kare..." value="{{ query }}">
<button type="submit">Search</button>
<button type="button" id="voiceBtn">ðŸŽ¤ Voice</button>
</form>

<div id="results">
{% if results %}
  {% for r in results %}
  <div class="result">
    <b onclick="copyToClipboard('{{r['PO']}}')">PO: {{ r['PO'] }}</b><br>
    Party: {{ r['Party'] }}<br>
    Area: {{ r['Area'] }}<br>
    Material: {{ r['Material'] }}
  </div>
  {% endfor %}
{% endif %}
</div>

<script>
function copyToClipboard(text){
    navigator.clipboard.writeText(text);
    alert("PO copied: " + text);
}

// --- Voice recognition ---
const voiceBtn = document.getElementById('voiceBtn');
voiceBtn.onclick = () => {
    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    recognition.lang = 'en-US';
    recognition.interimResults = false;
    recognition.maxAlternatives = 1;

    recognition.onresult = (event) => {
        const spokenText = event.results[0][0].transcript.toUpperCase();
        document.getElementById('query').value = spokenText;
        document.getElementById('searchForm').submit();
    };
    recognition.onerror = (e) => { alert("Voice recognition error: "+e.error); };
    recognition.start();
};
</script>
</body>
</html>
