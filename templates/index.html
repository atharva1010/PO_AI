<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PO AI</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        input[type=text] { width: 400px; padding: 8px; }
        button { padding: 8px 12px; }
        #results { margin-top: 20px; }
        table { border-collapse: collapse; width: 80%; margin-top: 10px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>
    <h2>PO AI Search</h2>
    <form id="po-form">
        <input type="text" id="query" placeholder="Enter Party / Area / Material">
        <button type="submit">Search</button>
    </form>

    <div id="results"></div>

    <script>
        const form = document.getElementById("po-form");
        const resultsDiv = document.getElementById("results");

        form.addEventListener("submit", async (e) => {
            e.preventDefault();
            const query = document.getElementById("query").value;

            const response = await fetch("/ask", {
                method: "POST",
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                body: new URLSearchParams({ query })
            });
            const data = await response.json();

            if (Array.isArray(data.answer)) {
                let html = "<table><tr><th>PO</th><th>Party</th><th>Area</th><th>Material</th></tr>";
                data.answer.forEach(row => {
                    html += `<tr>
                        <td>${row.PO}</td>
                        <td>${row.Party}</td>
                        <td>${row.Area}</td>
                        <td>${row.Material}</td>
                    </tr>`;
                });
                html += "</table>";
                resultsDiv.innerHTML = html;
            } else {
                resultsDiv.innerHTML = `<p>${data.answer}</p>`;
            }
        });
    </script>
</body>
</html>
